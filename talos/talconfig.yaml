---
# yaml-language-server: $schema=https://raw.githubusercontent.com/budimanjojo/talhelper/master/pkg/config/schemas/talconfig.json
clusterName: ${clusterName}
talosVersion: 1.9.1
kubernetesVersion: 1.31.1
endpoint: https://192.168.1.17:6443

cniConfig:
  name: none

nodes:
  - hostname: control-plane-1
    controlPlane: true
    ipAddress: 192.168.1.17
    installDisk: /dev/sdb
    schematic:
      customization:
        systemExtensions:
          officialExtensions:
            # https://github.com/siderolabs/talos/issues/9529
            - siderolabs/i915
            - siderolabs/mei
  - hostname: worker-1
    controlPlane: false
    ipAddress: 192.168.1.16
    installDisk: dev/sdb

controlPlane:
  patches:
    - |-
      machine:
        kubelet:
          extraMounts:
            - destination: /var/data
              type: bind
              source: /var/data
              options:
                - bind
                - rshared
                - rw
    # Disable kube-proxy
    - |
      cluster:
        proxy:
          disabled: true
